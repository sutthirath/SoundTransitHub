{% extends 'base.html' %}

{% block content %}

<h2>Transit Arrival Time:</h2>

<div>
    <p id='eta'>0</p>
    <p>min</p>
</div>

{% endblock %}

<!-- Javascript for OneBusAway API -->
<Script>

// Variables
let requestURL = 'http://api.pugetsound.onebusaway.org/api/where/arrivals-and-departures-for-stop/1_75790.json?key=683488fe-ec3e-499e-ae74-6774058697bc';
let request = new XMLHttpRequest();
let estArrival = jsonObj["predictedArrivalTime"];

// Get JSON data
request.open('GET', requestURL);

request.responseType = 'json';

request.send();

request.onload = function() {
    let arrivalTime = request.response;
    etaData();
}

// Functions
function etaData() {
    let eta = document.getElementById(eta);
    eta.textContent = formattedDate;
}

// Convert JSON timestamp to readable time
var d = new Date(1245398693390);
var formattedDate = d.getDate() + "-" + (d.getMonth() + 1) + "-" + d.getFullYear();
var hours = (d.getHours() < 10) ? "0" + d.getHours() : d.getHours();
var minutes = (d.getMinutes() < 10) ? "0" + d.getMinutes() : d.getMinutes();
var formattedTime = hours + ":" + minutes;

formattedDate = formattedDate + " " + formattedTime;

</Script>